<docs lang="markdown">
    [TODO: write documentation for this plugin.]
</docs>
<config lang="json">
    {
    "name": "JSON-Schema-Output",
    "type": "window",
    "tags": [],
    "ui": "",
    "version": "0.1.0",
    "api_version": "0.1.2",
    "description": "[TODO: describe this plugin with one sentence.]",
    "icon": "extension",
    "inputs": null,
    "outputs": null,
    "env": "",
    "requirements": [
    "https://cdn.jsdelivr.net/npm/vega@5.3.4/build/vega.js"],
    "dependencies": [],
    "defaults": {"w": 20, "h": 10}
    }
</config>
<script lang="javascript">
class ImJoyPlugin {
    async setup() {

    }

    async run(my) {
    	let container = document.getElementById('container')

    	if (my.data && my.data.length > 0) {
    		let len = my.data.length
    		for (let i = 0; i < len; i++) {
    			
    			
    			if (my.data[i].schema) {
    				let div = document.createElement('div')
    				div.id = 'view' + i
    				console.log(div.id)
    				container.appendChild(div)
    				let view = new vega.View(vega.parse(my.data[i].schema), {
		                renderer: 'canvas',
		                container: '#' + div.id,
		                hover: true
		            });
		            view.runAsync()
    			}

    			if (my.data[i].message) {
    				console.log(my.data[i].message)
    				let p = document.createElement('p')
    				p.innerHTML = my.data[i].message
    				container.appendChild(p)
    			}

    		}
    	}

    }
}

api.export(new ImJoyPlugin())
</script>
<window lang="html">
    <div id="container">
    </div>
</window>
<style lang="css">
</style>